{"componentChunkName":"component---src-templates-post-js-content-file-path-home-runner-work-varya-github-com-varya-github-com-content-posts-publish-packages-on-github-index-md","path":"/blog/publish-packages-on-github/","result":{"data":{"mdx":{"id":"56dc2142-b21b-5f31-9fb2-78e2f36de2a7","body":"\n<div data-excerpt>\n\nOften happens that an npm package should be published to a secure registry. In many cases, organizations have their own and all the internal stuff goes there. But what to do if your organization does not have anything like that? Apparently, [Github Packages](https://docs.github.com/en/packages) are the way to go. In case your repository is private, its packages will be too! Below, I describe a simple workflow that I set today.\n\n</div>\n\nIn this case, the packages are built and published in a pipeline operated by [Github Actions](https://github.com/features/actions). To set a workflow there, you would need to create a YAML file in the `.github/workflows/` folder. This is mine, for a package called `@yourscope/design-library`.\n\n```\nname: Release library\n\non:\n  push:\n    branches:\n      - main\n  workflow_dispatch:\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v3\n\n      - name: Install NodeJS\n        uses: actions/setup-node@v3\n        with:\n          node-version: \"16\"\n          registry-url: \"https://npm.pkg.github.com\"\n          scope: \"@yourscope\"\n\n      ### Check in, install, and build as your project needs it\n\n      - name: Release package\n        run: |\n          npm publish\n        env:\n          NODE_AUTH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n```\n\nNote that when publishing, there should be the `NODE_AUTH_TOKEN` environmental variable available. However, its value is `GITHUB_TOKEN` taken from secrets. You don't need to generate such a secret, your repository already has it in the background.\n\nAnother thing to spot is that when installing Node, you should define the npm registry and the scope. That can be done with additional parameters as shown in the code example.\n\n## How to release?\n\nReleases are happening in a pipeline via GitHub Actions once the `main` branch is updated. Releases are successful if the version number is unique. Practically, that means that a design-system developer needs to change the version number to trigger the release. There is room for improvement — it would be much nicer not to run the publishing job if the package of such a version already exists.\n\n## How to get the package?\n\n### Authentification at GitHub Packages\n\nThe GitHub Package registry is not open, you should get an access to it. For that, you need to authenticate.\n\n1. Create your _Personal Access Token_ at GitHub here https://github.com/settings/tokens\n   - It's a good habit to have a separate token for each project\n   - Name it using the _Note_ field so that later you understand what the token is for\n   - The token should at least have _read:packages_ permission\n   - Do not forget to copy the token after you have it generated\n2. Login to the npm registry:\n   ```\n   npm login --scope=@yourscope --registry=https://npm.pkg.github.com\n   > Username: USERNAME\n   > Password: TOKEN\n   > Email: PUBLIC-EMAIL-ADDRESS\n   ```\n\nFor more information, follow the official GitHub documentation: https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry#authenticating-with-a-personal-access-token\n\n### Installing the design-system package at the very first time\n\nBefore installation, you need to communicate that `@yourscope` npm packages should\nbe taken from GitHub Packages. You can do it by adding an `.npmrc` file to the root of your project. The content of the file should be as the following:\n\n```\n@yourscope:registry=https://npm.pkg.github.com\n```\n\nKeep the `.npmrc` file under version control so that your colleagues also could get the packages from the right place.\n\nNow, you can install the package:\n\n```\nnpm install --save @yourscope/design-system\n```\n\nor\n\n```\nyarn add @yourscope/design-system\n```\n\n### Installing project dependencies\n\nIf you have a project with `@yourscope/design-system` as a dependency, when being authorized, you should be able to install it together with all the other dependencies:\n\n```\nnpm install\n```\n\nor\n\n```\nyarn\n```\n","fields":{"slug":"blog/publish-packages-on-github/","disqusIdentifier":"blog-publish-packages-on-github","readingTime":{"minutes":2.81}},"frontmatter":{"title":"GitHub package — way to go for your private npm packages","subTitle":null,"date":"03 August 2022","v2":null,"old":null,"tumblr":null,"tags":null,"meta":{"desc":"Step-by-step guide on how to use a free GitHub package registry to store private npm packages (often needed for the design systems). The article shows how to set up an automatic workflow for publishing and how to get the packages in use.\n"},"canonical":null,"cover":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080828","images":{"fallback":{"src":"/static/597e8fb61204ff6aed90e726fab7adcc/fae27/storage.jpg","srcSet":"/static/597e8fb61204ff6aed90e726fab7adcc/fae27/storage.jpg 3024w","sizes":"3024px"},"sources":[{"srcSet":"/static/597e8fb61204ff6aed90e726fab7adcc/7d916/storage.webp 3024w","type":"image/webp","sizes":"3024px"}]},"width":3024,"height":4032}}}}},"site":{"siteMetadata":{"siteUrl":"https://varya.me"}}},"pageContext":{"slug":"blog/publish-packages-on-github/","prev":{"id":"b9a72261-6027-5ef6-b89d-cc4840df585d","fields":{"slug":"blog/shared-project-vision/","disqusIdentifier":"blog-shared-project-vision","level":1,"fileRelativePath":"shared-project-vision/index.md","lang":"en","readingTime":{"minutes":4.55}},"frontmatter":{"title":"Shared project vision — a series of exercises for teams","subTitle":null,"link":null,"v2":null,"old":null,"date":"2021-10-07T00:00:00.000Z","layout":null,"tags":null},"internal":{"contentFilePath":"/home/runner/work/varya.github.com/varya.github.com/content/posts/shared-project-vision/index.md"}},"next":{"id":"645eb4a3-6f5d-5684-b2d6-102a672e2ca0","fields":{"slug":"blog/design-system-versioning-basics/","disqusIdentifier":"blog-design-system-versioning-basics","level":1,"fileRelativePath":"design-system-versioning-basics/index.md","lang":"en","readingTime":{"minutes":3.18}},"frontmatter":{"title":"Mastering Version Control — Best Practices for Design System Versioning","subTitle":null,"link":null,"v2":null,"old":null,"date":"2023-01-30T00:00:00.000Z","layout":null,"tags":null},"internal":{"contentFilePath":"/home/runner/work/varya.github.com/varya.github.com/content/posts/design-system-versioning-basics/index.md"}},"fileSourceUrl":"https://github.com/varya/varya.github.com/edit/develop/content/posts/publish-packages-on-github/index.md","frontmatter":{"title":"GitHub package — way to go for your private npm packages","date":"2022-08-03T00:00:00.000Z","cover":"storage.jpg","meta":{"desc":"Step-by-step guide on how to use a free GitHub package registry to store private npm packages (often needed for the design systems). The article shows how to set up an automatic workflow for publishing and how to get the packages in use.\n"}}}},"staticQueryHashes":[],"slicesMap":{}}