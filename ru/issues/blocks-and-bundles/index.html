<!DOCTYPE html>
<html class="page page_ru" lang="ru">
<head>
    <meta charset="utf-8"/>
    <title>Блоки как кирпичи и бандлы как дома</title>
    <link  rel="stylesheet" href="/desktop.bundles/index/index.min.css" />
    <script>
    (function(d, s, l, r) {
    if (typeof(s) !== 'undefined' && l.getItem('varya.me.fonts')) {
        r = [
            '<style>',
            l.getItem('varya.me.fonts'),
            '</style>'
        ];
        document.write(r.join(''));
    }

    })(document, Storage, localStorage);
    </script>
</head>
<body class="page page__body">
    <header class="header">
        <div class="header__left candies i-bem"
            data-bem='{ "candies" : { "size" : { "max" : 28, "min" : 12 }, "reverse" : true } }'></div>
        <logo class="logo header__center">···<b class="var">var</b>·<b class="ya">ya</b>;<b class="cursor"></b></logo>
        <div class="header__right candies i-bem"
            data-bem='{ "candies" : { "size" : { "max" : 28, "min" : 12 } } }'></div>
    </header>
    <div class="layout">
        <section class="main">
            <ul class="languages">
            
                <li class="languages__lang">
                    
                    <a href="/en/issues/blocks-and-bundles">
                        en
                    </a>
                    
                </li>
                
                <li class="languages__lang">
                    
                        ru
                    
                </li>
                
            </ul>
            <div class="article" role="main">
    <div class="article__body box__body">
        <h1 class="article__header">
            Блоки как кирпичи и бандлы как дома
        </h1>
    </div>
    <div class="article__text box__island">
        <script type="text/javascript" src="//yandex.st/share/share.js"
        charset="utf-8"></script>
        <div class="share yashare-auto-init" data-yashareL10n="{{ lang }}"
            data-yashareQuickServices="twitter,facebook,gplus,vkontakte" data-yashareTheme="counter"
        ></div>
        <span class="article__details author vcard">
            Опубликовано
            15th February 2014
        </span>
        <p>Некотрое время назад мой знакомый, который делает проект на полном стеке БЭМ
(BEM-CSS, i-bem.js и BEMHTML-шаблоны),
задал мне несколько вопросов об использовании
<a href="https://github.com/bem/project-stub/tree/14e24fd17ba66a357a2f6fcdce045065b4eb5d6c">BEM project
stub</a>.
Отвечая на вопрос, я пообещала опубликовать ответ в виде текста, потому что
многие вещи вокруг БЭМ не проговариваются, считаясь слишком простыми — и
ошибочно!<excerpt/></p>
<p>Вопрос был о конфигурационном файле <code>.bem/make.js</code>, который нужен при
использовании
<a href="http://bem.info/tools/bem/bem-tools/">bem tools</a>
для сборки страниц.
<a href="https://github.com/bem/project-stub/blob/14e24fd17ba66a357a2f6fcdce045065b4eb5d6c/.bem/make.js#L12">Строчки 12 и
13</a>
описывают регулярные выражения для <code>blocks</code> и <code>bundles</code>. Не сразу понятно,
что это значит.</p>
<p>Вообще эти выражения нужны, чтобы распознать папки на файловой системе. Те,
которые заканчиваются на <code>.blocks</code> — для блоков, а те, что заканчиваются на
<code>.bundles</code> — для бандлов (страниц). Под эти выражения, например, подходят папки
<code>desktop.blocks</code> и <code>desktop.bundles</code> из project-stub.</p>
<p>Для чего нужна папка <code>desktop.blocks</code>, должно быть понятно. Поскольку БЭМ —
модульный паттерн, необходимо место для хранения модулей, то есть блоков. Каждый
блок — это директория, содержащая все файлы, нужные для каждого конкретного
интерфейсного модуля.</p>
<p>Вот, например, <a href="https://github.com/varya/online-shop-dummy/tree/master/desktop.blocks">набор блоков одного
проекта</a>.</p>
<p>Папка <code>desktop.bundles</code> нуждается в пояснении. Она содержит страницы – результат
использования блоков. Каждая страница помещена в отдельную директорию, внутри
которой располагаются все файлы, нужные для страницы.
Можно снова посмотреть
<a href="https://github.com/varya/online-shop-dummy/tree/gh-pages/desktop.bundles">пример из предыдущего
проекта</a>.</p>
<p>Разница в том, что файлы блоков созданы разработчиком, а файлы бандлов созданы
bem tools. Для блоков это знакомые нам CSS, JavaScript и иногда шаблоны.</p>
<pre class="highlight"><code class="hljs stylus">├── desktop.blocks/
│   ├── goods/
│   │   ├── &lt;<span class="hljs-tag">a</span> href=<span class="hljs-string">"https://github.com/varya/online-shop-dummy/blob/master/desktop.blocks/goods/goods.bemhtml"</span>&gt;goods.bemhtml&lt;/a&gt;
│   │   ├── &lt;<span class="hljs-tag">a</span> href=<span class="hljs-string">"https://github.com/varya/online-shop-dummy/blob/master/desktop.blocks/goods/goods.css"</span>&gt;goods.css&lt;/a&gt;
│   │   ├── &lt;<span class="hljs-tag">a</span> href=<span class="hljs-string">"https://github.com/varya/online-shop-dummy/blob/master/desktop.blocks/goods/goods.deps.js"</span>&gt;goods<span class="hljs-class">.deps</span><span class="hljs-class">.js</span>&lt;/a&gt;
│   │   └── &lt;<span class="hljs-tag">a</span> href=<span class="hljs-string">"https://github.com/varya/online-shop-dummy/blob/master/desktop.blocks/goods/goods.ie.css"</span>&gt;goods<span class="hljs-class">.ie</span><span class="hljs-class">.css</span>&lt;/a&gt;</code></pre>

<p>Проводя параллели для БЭМ (и любого другого модульного паттерна) в реальном
мире, можно сказать, что блок — это кирпичик.</p>
<p><img src="http://img-fotki.yandex.ru/get/6730/14441195.30/0_7e0f8_33c1c86c_L.jpg" alt=""></p>
<p>Файлы бандлов — это тоже файлы, нужные для браузера: CSS, JavaScript, HTML. <em>Ни
один из них не написан разработчиком, они созданы bem tools</em>. Можете посмотреть
внутрь файлов и убедиться, что код абсолютно &quot;роботный&quot;.</p>
<pre class="highlight"><code class="hljs stylus">├── desktop.bundles/
│   ├── index/
│   │   ├── &lt;<span class="hljs-tag">a</span> href=<span class="hljs-string">"https://github.com/varya/online-shop-dummy/blob/gh-pages/desktop.bundles/index/_index.css"</span>&gt;_index.css&lt;/a&gt;
│   │   ├── &lt;<span class="hljs-tag">a</span> href=<span class="hljs-string">"https://github.com/varya/online-shop-dummy/blob/gh-pages/desktop.bundles/index/_index.js"</span>&gt;_index.js&lt;/a&gt;
│   │   ├── &lt;<span class="hljs-tag">a</span> href=<span class="hljs-string">"https://github.com/varya/online-shop-dummy/blob/gh-pages/desktop.bundles/index/index.bemjson.js"</span>&gt;index<span class="hljs-class">.bemjson</span><span class="hljs-class">.js</span>&lt;/a&gt;
│   │   └── &lt;<span class="hljs-tag">a</span> href=<span class="hljs-string">"https://github.com/varya/online-shop-dummy/blob/gh-pages/desktop.bundles/index/index.html"</span>&gt;index.html&lt;/a&gt;</code></pre>


<p>Для понимания bem tools представьте, что это строительный кран. Он берет
строительные блоки и возводит из них дом.</p>
<p><img src="http://img-fotki.yandex.ru/get/9058/14441195.30/0_7e0f3_ff76f66a_L.jpg" alt=""></p>
<p>Хотя, кроме <em>.js, </em>.css и *.html файлов, всё-таки есть один файл, написанный
разрабочиком.
Это
<a href="https://github.com/varya/online-shop-dummy/blob/gh-pages/desktop.bundles/index/index.bemjson.js">index.bemjson.js</a>
— JSON описание того, что за блоки нужны на странице и какова их древовидная
структура. Звучит логично, ведь только человек знает, что нужно показать на
странице. Всё остальное делают bem tools. Получив информацию о том, какие блоки
нужны для страницы, они берут их код из <code>desktop.blocks</code> и формируют с их
помощью страницу.</p>
<p>Продолжая пример со строительством дома, можно сказать что <code>page.bemjson.js</code> —
это чертеж.</p>
<p><img src="http://img-fotki.yandex.ru/get/6704/14441195.30/0_7e1ba_9dacd537_L.jpg" alt=""></p>
<p>Но почему же <code>bem tools</code> нужно регулярное выражение в настройках?</p>
<p>Это несложно. Все папки, которыми оперирует <code>bem tools</code> — это <code>уровни
переопределения</code>. Должно быть легче, если представлять уровень как набор
сущностей. Уровень блоков представлен папкой <code>desktop.blocks</code>, а уровень страниц
— папкой <code>desktop.pages</code>. В конфигурационной папке
<a href="https://github.com/bem/project-stub/tree/14e24fd17ba66a357a2f6fcdce045065b4eb5d6c/.bem/levels">.bem/levels/</a>
есть инструкции, по которым bem tools понимают, что делать с уровнями разных
типов.</p>
<p>Выделяя в проекте блоки и бандлы, можно делать разные наборы блоков и разные
бандлы, собранные из этих наборов. Например, блоки для desktop и touch версий
сайта могут храниться в одном репозитории. И страницы, собранные из таких блоков
— тоже.</p>
<pre class="highlight"><code class="hljs undefined">├── desktop.blocks/
├── desktop.bundles/
├── touch.blocks/
└── touch.bundles/</code></pre>

<p>Возвращаясь к примерам из реального мира, не только кирпичики могут быть
модулями, но и детальки LEGO.</p>
<p><img src="http://img-fotki.yandex.ru/get/6704/14441195.30/0_7e0f6_f69c7d44_L.jpg" alt=""></p>
<p>Из них также можно построить дом. Немножечко другой, конечно.</p>
<p><img src="http://img-fotki.yandex.ru/get/9326/14441195.30/0_7e0f4_3d999550_L.jpg" alt=""></p>
<p>Если пойти дальше, вы можете выделить код блоков, общий для всех платформ, и
хранить его отдельно.</p>
<pre class="highlight"><code class="hljs axapta">├── <span class="hljs-keyword">common</span>.blocks/
├── desktop.blocks/
├── desktop.bundles/
├── touch.blocks/
└── touch.bundles/</code></pre>

<p>С такой структурой desktop версия формируется из кода блоков уровней
<code>common.blocks</code> и <code>desktop.blocks</code>, а touch версия — из уровней <code>common.blocks</code>
и <code>touch.blocks</code>.</p>
<p><img src="http://img-fotki.yandex.ru/get/6725/14441195.30/0_7e0f5_3e107fd4_L.jpg" alt=""></p>
<p>И в заключении, я не перестаю радоваться идее проекта
<a href="https://github.com/bem/project-stub/">BEM project
stub</a>. Сама постоянно использую его,
начиная новые проекты. Туториал о
<a href="http://ru.bem.info/articles/start-with-project-stub/">старте проекта на полном стеке
БЭМ</a> показывает, как именно.
Так же БЭМ использует и знакомый, задавший мне вопрос. Я никогда раньше не
подозревала, что project stub позволяет начать работы с БЭМ без знания всего
того, что описано выше. :-)</p>
<p>Кстати, написав все это, я поняла, что описание основ БЭМ для меня несложно и
занимает разумное время. При этом (я надеюсь!), это очень полезно для других.
Так что спрашивайте всё, что вы хотите знать.</p>

    </div>
    <div class="comments">
        <div class="comments__box box__body">
            <h4 class="comments__header">
                Обсуждение
            </h4>
        </div>
        <div class="comments__body box__island">
            
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'varya'; // required: replace example with your forum shortname

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            
        </div>
    </div>
    <div class="related">
        <div class="related__body box__body">
            <h4 class="related__header">
                Кстати
            </h4>
        </div>
        <div class="related__text box__island">
                <a href="https://github.com/varya/varya.github.com/issues/new?title=Feedback for Блоки как кирпичи и бандлы как дома">
                Создайте для меня issue на GitHub</a>, если вы заметили ошибку или хотите дополнить статью.
                Или вы можете
                <a href="https://github.com/varya/varya.github.com/edit/develop/src/documents/posts/2014-01-15-blocks-and-bundles_ru.html.md">отредактировать пост самостоятельно и послать мне патч</a>.
        </div>
    </div>
</div>
        </section>
        <nav class="sidebar">
        <ul class="menu-vert">
            <h3 class="menu-vert__title box__title">
                На этом сайте
            </h3>
            
                <li class="menu-vert__item ">
                    <a class="link" href="/ru/posts">
                        Блог
                    </a>
                </li>
            
                <li class="menu-vert__item ">
                    <a class="link" href="/ru/content">
                        Статьи и презентации
                    </a>
                </li>
            
                <li class="menu-vert__item ">
                    <a class="link" href="/ru">
                        Обо мне
                    </a>
                </li>
            
            </ul>
            <div class="github i-bem"
                data-bem='{ "github" : { "user" : "varya" } }'>
                <div class="github__header"></div>
                <div class="github__body"></div>
            </div>
        </nav>
        <aside class="prompting">
            <ul class="social-ico menu-vert">
                <li class="menu-vert__item">
                    <ul class="social-ico__text menu-vert">
                        <li class="menu-vert__item">
                            <a class="link social-ico__rss-text" href="/en/feed.xml" title="New on Varya.me in English">en</a>
                        </li>
                        <li class="menu-vert__item">
                            <a class="link social-ico__rss-text" href="/ru/feed.xml" title="Новые записи на Varya.me">ru</a>
                        </li>
                    </ul>
                    <a class="link social-ico__ico social-ico__ico_type_rss" href="/feed.xml" title="New on Varya.me"></a>
                </li>
                <li class="menu-vert__item">
                <a class="link social-ico__ico social-ico__ico_type_twitter"
                    href="https://twitter.com/toivonens"
                    title="@toivonens"
                    target="_blank"></a>
                </li>
                <li class="menu-vert__item">
                    <a class="link social-ico__ico social-ico__ico_type_github" href="https://github.com/varya" target="_blank"></a>
                </li>
                <li class="menu-vert__item">
                    <a class="link social-ico__ico social-ico__ico_type_facebook" href="http://www.facebook.com/varvara.stepanova.9" target="_blank"></a>
                </li>
                <li class="menu-vert__item">
                    <a class="link social-ico__ico social-ico__ico_type_linkedin" href="http://www.linkedin.com/pub/varvara-stepanova/30/72a/96b" target="_blank"></a>
                </li>
            </ul>
        </aside>
    </div>
    <div class="footer__outer">
        <footer class="footer">
            <div class="footer__left">
            </div>
            <div class="footer__center">
                <a class="link  link_text  link_wrapper" href="http://varya.me/ru/">
                    © 2015
                    <span class="link__inner">Варя Степанова</span>.
                </a>
                <a class="link  link_wrapper  link_twitter"
                    href="https://twitter.com/toivonens"
                    title="@toivonens">
                    <img alt="Twitter" class="ico" src="http://favicon.yandex.net/favicon/twitter.com" title="Twitter"/>
                    <span class="link__inner">Читайте меня в Твиттере</span>!
                </a>
            </div>
            <div class="footer__right">
            </div>
        </footer>
    </div>
    <!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20478625 = new Ya.Metrika({id:20478625, clickmap:true, trackLinks:true, accurateTrackBounce:true, trackHash:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/20478625" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter -->
    <script src="http://yandex.st/jquery/1.7.2/jquery.min.js"></script>
    <script src="/desktop.bundles/index/index.min.js" async defer></script>
</body>
</html>
