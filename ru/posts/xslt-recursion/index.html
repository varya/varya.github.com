<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.c70262ae60a6888672d4.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#073642}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.32.13"/><title data-react-helmet="true"></title><meta data-react-helmet="true" name="description" content="Varya.me — design and development"/><meta data-react-helmet="true" property="og:url" content="https://varya.me/ru/posts/xslt-recursion/"/><meta data-react-helmet="true" property="og:title" content="Эффективное использование рекурсии в XSL - Varya.me"/><meta data-react-helmet="true" property="og:description" content="Varya.me — design and development"/><meta data-react-helmet="true" property="og:image" content="https://varya.me/preview.jpg"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="varya_en"/><meta data-react-helmet="true" name="twitter:site" content="@varya_en"/><meta data-react-helmet="true" name="twitter:title" content="Эффективное использование рекурсии в XSL - Varya.me"/><meta data-react-helmet="true" name="twitter:description" content="Varya.me — design and development"/><meta data-react-helmet="true" name="twitter:image" content="https://varya.me/preview.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="Эффективное использование рекурсии в XSL - Varya.me"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#666"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><style data-styled="" data-styled-version="5.3.6">.bxGlvH{display:inline-block;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;width:24px;height:24px;fill:#999999;stroke:#999999;}/*!sc*/
.bxGlvH g{fill:inherit;stroke:inherit;}/*!sc*/
.bxGlvH *:not([stroke])[fill="none"]{stroke-width:0;}/*!sc*/
.bxGlvH *[stroke*="#"],.bxGlvH *[STROKE*="#"]{stroke:inherit;fill:none;}/*!sc*/
.bxGlvH *[fill-rule],.bxGlvH *[FILL-RULE],.bxGlvH *[fill*="#"],.bxGlvH *[FILL*="#"]{fill:inherit;stroke:none;}/*!sc*/
data-styled.g3[id="StyledIcon-sc-ofa7kd-0"]{content:"bxGlvH,"}/*!sc*/
.hGKrqd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;height:100%;}/*!sc*/
.jAyEEY{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;width:100%;box-shadow:0px 4px 8px rgba(0,0,0,0.20);}/*!sc*/
.deGBqe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;margin-left:auto;margin-right:auto;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;height:62px;width:1152px;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:24px;}/*!sc*/
@media only screen and (max-width:768px){.deGBqe{margin-left:auto;margin-right:auto;}}/*!sc*/
@media only screen and (max-width:768px){.deGBqe{padding:12px;}}/*!sc*/
.RBDMu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}/*!sc*/
.dyDMHJ{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}/*!sc*/
.ihfbaW{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}/*!sc*/
.cdfNru{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:90%;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;overflow:auto;}/*!sc*/
.dLwaJD{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;padding-bottom:24px;}/*!sc*/
@media only screen and (max-width:768px){.dLwaJD{padding-bottom:12px;}}/*!sc*/
.fSVOry{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;background-color:#85D8F3;color:rgba(0,0,0,0.85);min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:384px;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;}/*!sc*/
.bCUInm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}/*!sc*/
.hktTNW{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;width:100%;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}/*!sc*/
.WmMrl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;margin-left:auto;margin-right:auto;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:1152px;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;padding:24px;}/*!sc*/
@media only screen and (max-width:768px){.WmMrl{margin-left:auto;margin-right:auto;}}/*!sc*/
@media only screen and (max-width:768px){.WmMrl{padding:12px;}}/*!sc*/
.bnxvkn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;margin-bottom:auto;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;width:100%;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-top:24px;padding-bottom:24px;}/*!sc*/
@media only screen and (max-width:768px){.bnxvkn{margin-bottom:auto;}}/*!sc*/
@media only screen and (max-width:768px){.bnxvkn{padding-top:12px;padding-bottom:12px;}}/*!sc*/
.juXWcg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#F8F8F8;color:rgba(0,0,0,0.85);min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:24px;}/*!sc*/
@media only screen and (max-width:768px){.juXWcg{padding:12px;}}/*!sc*/
.bnacTc{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;margin-left:auto;margin-right:auto;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:1152px;}/*!sc*/
@media only screen and (max-width:768px){.bnacTc{margin-left:auto;margin-right:auto;}}/*!sc*/
.cnYPdO{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;grid-area:call-to-action;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}/*!sc*/
.gDPPjv{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;grid-area:button;margin:24px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:24px;}/*!sc*/
@media only screen and (max-width:768px){.gDPPjv{margin:12px;}}/*!sc*/
@media only screen and (max-width:768px){.gDPPjv{padding:12px;}}/*!sc*/
.kZBqJu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;grid-area:social;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}/*!sc*/
.bSRJmJ{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;background-color:#F8F8F8;color:rgba(0,0,0,0.85);min-width:0;min-height:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}/*!sc*/
.fieDOB{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;max-width:100%;grid-area:copyright;margin-top:24px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:0;min-height:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}/*!sc*/
@media only screen and (max-width:768px){.fieDOB{margin-top:12px;}}/*!sc*/
data-styled.g4[id="StyledBox-sc-13pk1d4-0"]{content:"hGKrqd,jAyEEY,deGBqe,RBDMu,dyDMHJ,ihfbaW,cdfNru,dLwaJD,fSVOry,bCUInm,hktTNW,WmMrl,bnxvkn,juXWcg,bnacTc,cnYPdO,gDPPjv,kZBqJu,bSRJmJ,fieDOB,"}/*!sc*/
.gLXLOS{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;width:24px;}/*!sc*/
@media only screen and (max-width:768px){.gLXLOS{width:12px;}}/*!sc*/
.iamwzK{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;width:3px;}/*!sc*/
@media only screen and (max-width:768px){.iamwzK{width:2px;}}/*!sc*/
data-styled.g5[id="StyledBox__StyledBoxGap-sc-13pk1d4-1"]{content:"gLXLOS,iamwzK,"}/*!sc*/
.cubANB{font-size:40px;line-height:40px;color:rgb(236,78,75,1);font-weight:bold;font-family:Monaco;}/*!sc*/
.gKEhhu{font-size:40px;line-height:40px;color:#f8d179;font-weight:bold;font-family:Monaco;}/*!sc*/
.cHDqzo{font-size:40px;line-height:40px;color:rgba(0,0,0,0.45);font-weight:bold;font-family:Monaco;}/*!sc*/
.hlFauk{font-size:14px;line-height:20px;color:#ffffff;font-weight:bold;}/*!sc*/
.iZZpUp{font-size:14px;line-height:20px;color:rgba(0,0,0,0.45);}/*!sc*/
data-styled.g10[id="StyledText-sc-1sadyjn-0"]{content:"cubANB,gKEhhu,cHDqzo,hlFauk,iZZpUp,"}/*!sc*/
.iTpQMf{display:inline-block;box-sizing:border-box;cursor:pointer;font:inherit;-webkit-text-decoration:none;text-decoration:none;margin:0;background:transparent;overflow:visible;text-transform:none;color:inherit;outline:none;border:none;padding:0;text-align:inherit;}/*!sc*/
.iTpQMf:focus{outline:none;box-shadow:0 0 2px 2px #85D8F3;}/*!sc*/
.iTpQMf:focus > circle,.iTpQMf:focus > ellipse,.iTpQMf:focus > line,.iTpQMf:focus > path,.iTpQMf:focus > polygon,.iTpQMf:focus > polyline,.iTpQMf:focus > rect{outline:none;box-shadow:0 0 2px 2px #85D8F3;}/*!sc*/
.iTpQMf:focus::-moz-focus-inner{border:0;}/*!sc*/
.iTpQMf:focus:not(:focus-visible){outline:none;box-shadow:none;}/*!sc*/
.iTpQMf:focus:not(:focus-visible) > circle,.iTpQMf:focus:not(:focus-visible) > ellipse,.iTpQMf:focus:not(:focus-visible) > line,.iTpQMf:focus:not(:focus-visible) > path,.iTpQMf:focus:not(:focus-visible) > polygon,.iTpQMf:focus:not(:focus-visible) > polyline,.iTpQMf:focus:not(:focus-visible) > rect{outline:none;box-shadow:none;}/*!sc*/
.iTpQMf:focus:not(:focus-visible)::-moz-focus-inner{border:0;}/*!sc*/
.iTpQMf:hover{color:rgb(236,78,75,1);-webkit-text-decoration:underline;text-decoration:underline;background:transparent;}/*!sc*/
.ewhtQA{display:inline-block;box-sizing:border-box;cursor:pointer;font:inherit;-webkit-text-decoration:none;text-decoration:none;margin:0;background:transparent;overflow:visible;text-transform:none;margin-left:3px;margin-right:3px;border:2px solid rgb(236,78,75,1);border-radius:5px;color:rgba(0,0,0,0.85);padding:4px 22px;font-size:18px;line-height:24px;background-color:rgb(236,78,75,1);color:#ffffff;border-radius:5px;-webkit-transition-property:color,background-color,border-color,box-shadow;transition-property:color,background-color,border-color,box-shadow;-webkit-transition-duration:0.1s;transition-duration:0.1s;-webkit-transition-timing-function:ease-in-out;transition-timing-function:ease-in-out;width:100%;height:100%;max-width:none;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;font-weight:bold;}/*!sc*/
.ewhtQA:hover{box-shadow:0px 0px 0px 2px rgb(236,78,75,1);}/*!sc*/
.ewhtQA:focus{outline:none;box-shadow:0 0 2px 2px #85D8F3;}/*!sc*/
.ewhtQA:focus > circle,.ewhtQA:focus > ellipse,.ewhtQA:focus > line,.ewhtQA:focus > path,.ewhtQA:focus > polygon,.ewhtQA:focus > polyline,.ewhtQA:focus > rect{outline:none;box-shadow:0 0 2px 2px #85D8F3;}/*!sc*/
.ewhtQA:focus::-moz-focus-inner{border:0;}/*!sc*/
.ewhtQA:focus:not(:focus-visible){outline:none;box-shadow:none;}/*!sc*/
.ewhtQA:focus:not(:focus-visible) > circle,.ewhtQA:focus:not(:focus-visible) > ellipse,.ewhtQA:focus:not(:focus-visible) > line,.ewhtQA:focus:not(:focus-visible) > path,.ewhtQA:focus:not(:focus-visible) > polygon,.ewhtQA:focus:not(:focus-visible) > polyline,.ewhtQA:focus:not(:focus-visible) > rect{outline:none;box-shadow:none;}/*!sc*/
.ewhtQA:focus:not(:focus-visible)::-moz-focus-inner{border:0;}/*!sc*/
data-styled.g12[id="StyledButton-sc-323bzc-0"]{content:"iTpQMf,ewhtQA,"}/*!sc*/
.dBQJGO{display:inline-block;box-sizing:border-box;cursor:pointer;font:inherit;-webkit-text-decoration:none;text-decoration:none;margin:0;background:transparent;overflow:visible;text-transform:none;border:none;border-radius:18px;padding:4px 12px;font-size:18px;line-height:24px;color:#999999;text-align:center;-webkit-transition-property:color,background-color,border-color,box-shadow;transition-property:color,background-color,border-color,box-shadow;-webkit-transition-duration:0.1s;transition-duration:0.1s;-webkit-transition-timing-function:ease-in-out;transition-timing-function:ease-in-out;font-weight:bold;}/*!sc*/
.dBQJGO > svg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;vertical-align:middle;}/*!sc*/
.dBQJGO:hover{color:#f8d179;}/*!sc*/
.dBQJGO:focus{outline:none;box-shadow:0 0 2px 2px #85D8F3;}/*!sc*/
.dBQJGO:focus > circle,.dBQJGO:focus > ellipse,.dBQJGO:focus > line,.dBQJGO:focus > path,.dBQJGO:focus > polygon,.dBQJGO:focus > polyline,.dBQJGO:focus > rect{outline:none;box-shadow:0 0 2px 2px #85D8F3;}/*!sc*/
.dBQJGO:focus::-moz-focus-inner{border:0;}/*!sc*/
.dBQJGO:focus:not(:focus-visible){outline:none;box-shadow:none;}/*!sc*/
.dBQJGO:focus:not(:focus-visible) > circle,.dBQJGO:focus:not(:focus-visible) > ellipse,.dBQJGO:focus:not(:focus-visible) > line,.dBQJGO:focus:not(:focus-visible) > path,.dBQJGO:focus:not(:focus-visible) > polygon,.dBQJGO:focus:not(:focus-visible) > polyline,.dBQJGO:focus:not(:focus-visible) > rect{outline:none;box-shadow:none;}/*!sc*/
.dBQJGO:focus:not(:focus-visible)::-moz-focus-inner{border:0;}/*!sc*/
data-styled.g13[id="StyledButtonKind-sc-1vhfpnt-0"]{content:"dBQJGO,"}/*!sc*/
.eVIBdA{margin-top:auto;margin-left:auto;margin-right:auto;font-family:Roboto;font-size:50px;line-height:56px;max-width:1200px;font-weight:900;overflow-wrap:break-word;color:#ffffff;max-width:100%;}/*!sc*/
@media only screen and (max-width:768px){.eVIBdA{margin-top:auto;}}/*!sc*/
@media only screen and (max-width:768px){.eVIBdA{margin-left:auto;}}/*!sc*/
@media only screen and (max-width:768px){.eVIBdA{margin-right:auto;}}/*!sc*/
@media only screen and (max-width:768px){.eVIBdA{font-size:34px;line-height:40px;max-width:816px;}}/*!sc*/
.fjsbec{font-family:Roboto;font-size:34px;line-height:40px;max-width:816px;font-weight:600;overflow-wrap:break-word;max-width:100%;}/*!sc*/
@media only screen and (max-width:768px){.fjsbec{font-size:26px;line-height:32px;max-width:624px;}}/*!sc*/
.gEhQsb{font-family:Roboto;font-size:18px;line-height:24px;max-width:432px;font-weight:600;overflow-wrap:break-word;max-width:100%;}/*!sc*/
@media only screen and (max-width:768px){.gEhQsb{font-size:16px;line-height:22px;max-width:384px;}}/*!sc*/
.iKIdCK{font-family:Roboto;font-size:26px;line-height:32px;max-width:624px;font-weight:600;overflow-wrap:break-word;max-width:100%;}/*!sc*/
@media only screen and (max-width:768px){.iKIdCK{font-size:18px;line-height:24px;max-width:432px;}}/*!sc*/
data-styled.g15[id="StyledHeading-sc-1rdh4aw-0"]{content:"eVIBdA,fjsbec,gEhQsb,iKIdCK,"}/*!sc*/
.dHNTAQ{box-sizing:border-box;font-size:inherit;line-height:inherit;color:rgb(236,78,75,1);font-weight:600;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;margin-left:12px;margin-right:12px;font-weight:300;}/*!sc*/
.dHNTAQ:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.fKoXkk{box-sizing:border-box;font-size:inherit;line-height:inherit;color:rgb(236,78,75,1);font-weight:600;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;font-weight:300;}/*!sc*/
.fKoXkk:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
data-styled.g16[id="StyledAnchor-sc-1rp7lwl-0"]{content:"dHNTAQ,fKoXkk,"}/*!sc*/
.yUXFi{display:grid;box-sizing:border-box;grid-template-areas:"call-to-action call-to-action button social" "copyright copyright copyright copyright" ". . . ." ". . . .";grid-template-columns:25% 25% 25% 25%;grid-template-rows:auto auto auto auto;}/*!sc*/
data-styled.g45[id="StyledGrid-sc-1wofa1l-0"]{content:"yUXFi,"}/*!sc*/
@font-face{font-family:'Roboto';font-style:normal;font-weight:300;src:local(''), url(/static/roboto-v20-latin_cyrillic-ext-300-1eca9764625c01cd6e16d2ed5e907b79.woff2) format('woff2'), url(/static/roboto-v20-latin_cyrillic-ext-300-6057e0fecd59cd7a4a0e5e89841f752c.woff) format('woff');}/*!sc*/
@font-face{font-family:'Roboto';font-style:italic;font-weight:300;src:local(''), url(/static/roboto-v20-latin_cyrillic-ext-300italic-ca89923854230c8af613643721d96f01.woff2) format('woff2'), url(/static/roboto-v20-latin_cyrillic-ext-300italic-634dfc5e8812ea7f821310c9223ed4f5.woff) format('woff');}/*!sc*/
@font-face{font-family:'Roboto';font-style:normal;font-weight:400;src:local(''), url(/static/roboto-v20-latin_cyrillic-ext-regular-fa18727aae742d5ccd18c6ab4470043e.woff2) format('woff2'), url(/static/roboto-v20-latin_cyrillic-ext-regular-f5e9a4eaaa88c13e9ebdb1751ef43789.woff) format('woff');}/*!sc*/
@font-face{font-family:'Roboto';font-style:normal;font-weight:900;src:local(''), url(/static/roboto-v20-latin_cyrillic-ext-900-55fb0a78a71810c9861bb308a0a02d36.woff2) format('woff2'), url(/static/roboto-v20-latin_cyrillic-ext-900-51402560a1ba17fd1b14832f75b30446.woff) format('woff');}/*!sc*/
.fFklwp{font-family:Roboto;font-size:18px;line-height:24px;font-weight:300;background-color:#FFFFFF;color:rgba(0,0,0,0.85);box-sizing:border-box;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;width:100vw;height:100vh;overflow:auto;}/*!sc*/
@font-face{font-family:'Roboto';font-style:normal;font-weight:300;src:local(''), url(/static/roboto-v20-latin_cyrillic-ext-300-1eca9764625c01cd6e16d2ed5e907b79.woff2) format('woff2'), url(/static/roboto-v20-latin_cyrillic-ext-300-6057e0fecd59cd7a4a0e5e89841f752c.woff) format('woff');}/*!sc*/
@font-face{font-family:'Roboto';font-style:italic;font-weight:300;src:local(''), url(/static/roboto-v20-latin_cyrillic-ext-300italic-ca89923854230c8af613643721d96f01.woff2) format('woff2'), url(/static/roboto-v20-latin_cyrillic-ext-300italic-634dfc5e8812ea7f821310c9223ed4f5.woff) format('woff');}/*!sc*/
@font-face{font-family:'Roboto';font-style:normal;font-weight:400;src:local(''), url(/static/roboto-v20-latin_cyrillic-ext-regular-fa18727aae742d5ccd18c6ab4470043e.woff2) format('woff2'), url(/static/roboto-v20-latin_cyrillic-ext-regular-f5e9a4eaaa88c13e9ebdb1751ef43789.woff) format('woff');}/*!sc*/
@font-face{font-family:'Roboto';font-style:normal;font-weight:900;src:local(''), url(/static/roboto-v20-latin_cyrillic-ext-900-55fb0a78a71810c9861bb308a0a02d36.woff2) format('woff2'), url(/static/roboto-v20-latin_cyrillic-ext-900-51402560a1ba17fd1b14832f75b30446.woff) format('woff');}/*!sc*/
.eisItN{font-family:Roboto;font-size:18px;line-height:24px;font-weight:300;background-color:#FFFFFF;color:rgba(0,0,0,0.85);box-sizing:border-box;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;}/*!sc*/
data-styled.g94[id="StyledGrommet-sc-19lkkz7-0"]{content:"fFklwp,eisItN,"}/*!sc*/
body{margin:0;}/*!sc*/
data-styled.g95[id="sc-global-hmgnLM1"]{content:"sc-global-hmgnLM1,"}/*!sc*/
.cVYDyA{font-size:18px;line-height:24px;max-width:none;text-align:left;}/*!sc*/
.gcuCcA{font-size:14px;line-height:20px;max-width:none;text-align:left;}/*!sc*/
data-styled.g103[id="StyledParagraph-sc-tbetod-0"]{content:"cVYDyA,gcuCcA,"}/*!sc*/
.dxnfjF{-webkit-letter-spacing:0.2em;-moz-letter-spacing:0.2em;-ms-letter-spacing:0.2em;letter-spacing:0.2em;-webkit-letter-spacing:normal;-moz-letter-spacing:normal;-ms-letter-spacing:normal;letter-spacing:normal;position:relative;}/*!sc*/
.dxnfjF > a.anchor{position:absolute;left:-24px;display:none;height:100%;}/*!sc*/
.dxnfjF:hover a.anchor{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
.dxnfjF a.anchor svg{fill:#999;}/*!sc*/
data-styled.g131[id="Heading__StyledHeading-sc-1sm1dki-0"]{content:"dxnfjF,"}/*!sc*/
.cMEZkU{background-image:url();background-size:cover;width:100%;position:relative;}/*!sc*/
.cMEZkU::after{content:"";height:100%;left:0;position:absolute;top:0;width:100%;background:linear-gradient( 180deg, rgba(255,255,255,0) 0%, rgba(0,0,0,0.7) 40%, rgba(0,0,0,0.85) 100% );}/*!sc*/
data-styled.g132[id="Hero__HeroHeader-sc-1t9btgc-0"]{content:"cMEZkU,"}/*!sc*/
.eKJexe{position:relative;z-index:1;text-align:center;padding:3rem;}/*!sc*/
data-styled.g133[id="Hero__HeroHeaderContent-sc-1t9btgc-1"]{content:"eKJexe,"}/*!sc*/
.dPnTqb,.dPnTqb:visited,.dPnTqb:hover,.dPnTqb:active{font-style:inherit;color:inherit;background-color:transparent;font-size:inherit;-webkit-text-decoration:none;text-decoration:none;font-variant:inherit;font-weight:inherit;line-height:inherit;font-family:inherit;}/*!sc*/
data-styled.g136[id="Link__AnchorWithoutStyle-sc-1sy1kqy-0"]{content:"dPnTqb,"}/*!sc*/
.etovcs.active{-webkit-text-decoration:underline;text-decoration:underline;color:rgb(236,78,75,1);}/*!sc*/
data-styled.g138[id="Menu__StyledButton-sc-13ccsfr-1"]{content:"etovcs,"}/*!sc*/
.iWdQfn{line-height:175%;font-weight:inherit;font-style:normal;text-align:justify;position:relative;}/*!sc*/
.cFFcIF{font-weight:inherit;font-style:normal;text-align:justify;position:relative;}/*!sc*/
data-styled.g139[id="Paragraph__StyledParagraph-sc-15exta6-0"]{content:"iWdQfn,cFFcIF,"}/*!sc*/
</style><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-3e231e9c75d1714f579e.js"/><link as="script" rel="preload" href="/framework-e5e95b94de229fe789b2.js"/><link as="script" rel="preload" href="/styles-2145f6021e9dfb9c659e.js"/><link as="script" rel="preload" href="/29107295-c94de8149487fc10d0b0.js"/><link as="script" rel="preload" href="/app-f4b7c1d760c3590389ba.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-f439b2c003b946e312ce.js"/><link as="fetch" rel="preload" href="/page-data/ru/posts/xslt-recursion/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/><style id="gatsby-inlined-css"></style><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#D0E0D8"/><meta name="apple-mobile-web-app-title" content="Lazywill"/><link rel="apple-touch-icon" href="/icons/apple-icon-57x57.png" sizes="57x57"/><link rel="apple-touch-icon" href="/icons/apple-icon-60x60.png" sizes="60x60"/><link rel="apple-touch-icon" href="/icons/apple-icon-72x72.png" sizes="72x72"/><link rel="apple-touch-icon" href="/icons/apple-icon-76x76.png" sizes="76x76"/><link rel="apple-touch-icon" href="/icons/apple-icon-114x114.png" sizes="114x114"/><link rel="apple-touch-icon" href="/icons/apple-icon-120x120.png" sizes="120x120"/><link rel="apple-touch-icon" href="/icons/apple-icon-144x144.png" sizes="144x144"/><link rel="apple-touch-icon" href="/icons/apple-icon-152x152.png" sizes="152x152"/><link rel="apple-touch-icon" href="/icons/apple-icon-180x180.png" sizes="180x180"/><link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="StyledGrommet-sc-19lkkz7-0 fFklwp"><div class="StyledBox-sc-13pk1d4-0 hGKrqd"><div class="StyledBox-sc-13pk1d4-0 jAyEEY"><header class="StyledBox-sc-13pk1d4-0 deGBqe"><a class="Link__AnchorWithoutStyle-sc-1sy1kqy-0 dPnTqb" href="/"><div class="StyledGrommet-sc-19lkkz7-0 eisItN"><div class="StyledBox-sc-13pk1d4-0 RBDMu"><span class="StyledText-sc-1sadyjn-0 cubANB">var </span><span class="StyledText-sc-1sadyjn-0 gKEhhu">ya</span><span class="StyledText-sc-1sadyjn-0 cHDqzo">;</span></div></div></a><div class="StyledBox__StyledBoxGap-sc-13pk1d4-1 gLXLOS"></div><div class="StyledGrommet-sc-19lkkz7-0 eisItN"><nav mode="horizontal" class="StyledBox-sc-13pk1d4-0 dyDMHJ"><a class="StyledAnchor-sc-1rp7lwl-0 dHNTAQ Menu__StyledButton-sc-13ccsfr-1 etovcs" href="/">Home</a><div class="StyledBox-sc-13pk1d4-0 ihfbaW"><div class="StyledBox-sc-13pk1d4-0 ihfbaW"><div aria-label="Navigation Menu" type="button" class="StyledButton-sc-323bzc-0 iTpQMf"><a class="StyledAnchor-sc-1rp7lwl-0 dHNTAQ Menu__StyledButton-sc-13ccsfr-1 etovcs" href="/services">Services</a></div></div></div><a class="StyledAnchor-sc-1rp7lwl-0 dHNTAQ Menu__StyledButton-sc-13ccsfr-1 etovcs" href="/projects">Projects</a><a class="StyledAnchor-sc-1rp7lwl-0 dHNTAQ Menu__StyledButton-sc-13ccsfr-1 etovcs" href="/blog">Blog</a><a class="StyledAnchor-sc-1rp7lwl-0 dHNTAQ Menu__StyledButton-sc-13ccsfr-1 etovcs" href="/contact">Contact</a></nav></div></header></div><div class="StyledBox-sc-13pk1d4-0 cdfNru"><main class="StyledBox-sc-13pk1d4-0 dLwaJD"><div class="StyledBox-sc-13pk1d4-0 fSVOry Hero__HeroHeader-sc-1t9btgc-0 cMEZkU"><div class="StyledBox-sc-13pk1d4-0 bCUInm Hero__HeroHeaderContent-sc-1t9btgc-1 eKJexe"><h1 class="StyledHeading-sc-1rdh4aw-0 eVIBdA Heading__StyledHeading-sc-1sm1dki-0 dxnfjF">Эффективное использование рекурсии в XSL</h1><div color="text-invert" class="StyledBox-sc-13pk1d4-0 hktTNW"><span class="StyledText-sc-1sadyjn-0 hlFauk">01 August 2009</span></div></div></div><div class="StyledBox-sc-13pk1d4-0 WmMrl"><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Перевод статьи <a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/xml/library/x-xslrecur/" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk">Use recursion effectively in XSL</a>.
Введение в XSL-рекурсию и приёмы для оптимизации её использования.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Эффективное и рациональное использование XSL-преобразований требует понимания,
как использовать XSL в качестве функционального языка, что означает понимание рекурсии.
Эта статья знакомит с ключевыми идеями рекурсии и особенностей её использования
в XSL.<excerpt></excerpt> Также объяснены приёмы для оптимизации преобразования XML и избегания ошибок
при использовании рекурсии. Каждая идея или метод сопровождаются примерами кода.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Сейчас в мире преобладают императивные языки программирования. Наиболее популярные языки - Java, C (и его различные
виды), Visual Basic и другие - на высоком абстрактном уровне работают, в основном, одинаково: вы задаёте некоторые
переменные, вызываете функции или операторы, которые меняют эти переменные, и возвращаете результат. Это сильное
приближение к программированию, и это, конечно, не всё.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Языки программирования другой породы, пока менее привычной, по крайней мере также сильны как их процедурные &quot;коллеги&quot;.
Эти языки названы <em>функциональными</em> или <em>декларативными</em> языками. Программы, написанные на этих языках, могут только
однажды определить переменные, и никогда не могут поменять хранимое значение однажды определённой переменной. Язык
программирования XSL и функциональный, и декларативный. Это означает, что разработчики, привыкшие писать на Java или C,
и изучающие XSL часто чувствуют себя не в своей тарелке, применяя самые передовые особенности XSL.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Из-за роста важности как приложений, так и web-разработчиков и завязанности на XSL-технологию, эффективное использование
XSL-преобразований не может быть проигнорировано. Так, наиболее важно научиться, как программировать в декларативной
манере. Это подразумевает близкое знакомство с <strong>рекурсией</strong>, основанное на методах её эффективного
использования и рационального решения текущих задач.</p><h2 class="StyledHeading-sc-1rdh4aw-0 fjsbec Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="введение в рекурсию на примере permalink" href="#%D0%B2%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B2-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D1%8E-%D0%BD%D0%B0-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D0%B5"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Введение в рекурсию на примере</h2><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Через использование рекурсивных функций декларативные языки способны предоставлять функциональность, подобную функциональности их императивных &quot;коллег&quot;. Это не значит, что императивные языки не могут использовать рекурсию. Большинство - могут. Разница в том, что декларативные языки используют рекурсию как основное средство деятельности, тогда как чаще всего это просто свойство в императивных языках.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Рассмотрим функцию, которая высчитывает факториал от некоторого положительного целого. Вкратце, факториал числа - это число, полученное путём умножения всех предшествующих ему чисел. Так, факториал от 4 (или 4!) - 1<em>2</em>3<!-- -->*<!-- -->4 = 24. Распечатка 1 показывает один из способов написать эту функцию на Java:</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 1 решение задачи про факториал с использованием цикла на java permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-1-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%D0%B8-%D0%BF%D1%80%D0%BE-%D1%84%D0%B0%D0%BA%D1%82%D0%BE%D1%80%D0%B8%D0%B0%D0%BB-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D1%86%D0%B8%D0%BA%D0%BB%D0%B0-%D0%BD%D0%B0-java"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 1. Решение задачи про факториал с использованием цикла на Java</h4><div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>number <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> number<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">*=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Пока это совершенно разумный код, он действительно пользуется тем фактом, что вы можете переопределить значения переменных в Java-программе. Без этой роскоши вы можете только решать задачу определением функций, как в Распечатке 2.</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 2 решение задачи про факториал с использованием рекурсии на java permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-2-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%D0%B8-%D0%BF%D1%80%D0%BE-%D1%84%D0%B0%D0%BA%D1%82%D0%BE%D1%80%D0%B8%D0%B0%D0%BB-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8-%D0%BD%D0%B0-java"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 2. Решение задачи про факториал с использованием рекурсии на Java</h4><div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>number <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> number <span class="token operator">*</span> <span class="token function">factorial</span><span class="token punctuation">(</span>number<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Результаты вызова этих двух реализаций вычисления факториала одинаковы. Вызов функции <em>factorial()</em> в теле метода
показывает, что вторая реализации использует рекурсию. Этот метод может быть визуально представлен как лестница.
Программа многократно спускается вниз, вызывая саму себя, собирая статическую информацию для каждого вызова пока не
упрется в условие выхода из рекурсии. Достигнув конца, она идёт обратно, возвращая различные состояния уже сделанных
вызовов, объединяя информацию, собранную на пути вниз, для получения финального результата. Пример про факториал показан
на рисунке.</p><img src="http://www.ibm.com/developerworks/xml/library/x-xslrecur/steps.gif" alt="Представление рекурсии в виде лестницы"/><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">В общем случае, рецепт создания рекурсивной функции включает в себя три ингредиента: условие выхода, код операции и рекурсивный вызов самого себя. В случае факториала, я вычисляю его для n путём вычисления факториала для n-1, n-2, n-3 и т.д. пока функция не достигнет условия выхода из серии - значения 1.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Так, если сейчас идея рекурсии ещё кажется немного смущающей, вы могли бы прервать чтение этой статьи и либо проследовать по некоторым ссылкам на эту тему в разделе <a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/xml/library/x-xslrecur/#resources" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk">Ресурсы</a>, либо попробовать написать несколько функций самостоятельно (например, напишите функцию для расчёта n-го числа из ряда Фибоначчи).</p><h2 class="StyledHeading-sc-1rdh4aw-0 fjsbec Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="общие использования рекурсии в xsl permalink" href="#%D0%BE%D0%B1%D1%89%D0%B8%D0%B5-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8-%D0%B2-xsl"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Общие использования рекурсии в XSL</h2><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Два общих сценария использования рекурсии в XSL такие:</p><ul><li>Когда у вас есть набор повторяющихся значений в исходном XML, и вы хотите, чтобы результат преобразования отражал что-то, касающееся всех этих значений. Например, если у вас есть каталог товаров в XML, и вы хотите представить эти товары в соответствии с общей ценой, вы захотите найти совокупную цену, используя рекурсивный шаблон.</li><li>Когда исходный XML содержит число <em>x</em> в теге, например <!-- -->&lt;<!-- -->countTo number=&quot;5&quot;/<!-- -->&gt;<!-- -->, и вы хотите представить некоторую информацию <em>x</em> раз в результирующей выдаче. Факториал - типичный пример такого случая, но я рассмотрю более сложный пример немного позже.</li></ul><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Я покажу рекурсивное решение, написанное на XSL для обоих сценариев, но сначала давайте взглянем на пример про факториал, решенный на XSL:</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 3 решение задачи про факториал с использованием рекурсии на xsl permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-3-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%D0%B8-%D0%BF%D1%80%D0%BE-%D1%84%D0%B0%D0%BA%D1%82%D0%BE%D1%80%D0%B8%D0%B0%D0%BB-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8-%D0%BD%D0%B0-xsl"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 3. Решение задачи про факториал с использованием рекурсии на XSL</h4><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>factorial<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$number &lt;= 1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>recursive_result<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>factorial<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$number - 1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$number * $recursive_result<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>template</span><span class="token punctuation">&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Этот шаблон содержит все &quot;игредиенты&quot; из рецепта для Java-рекурсии. Здесь есть условие выхода (проверка на равенство единице или нет): если условие выхода не выполняется, шаблон делает рекурсивный вызов самого себя (хранимый в переменной <em>recursive_result</em>). Наконец, для получения конечного результата совершается операция умножения между исходным числом и рекурсивно полученным значением. Вы также могли заметить, что XSL частно требует намного больше кода, чем решение той же задачи в других языках. Это всего лишь часть неоднозначностей в языке преобразования, который согласовывается с XML.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">###Рекурсия, вариант 1: Суммирование сквозь множество элементов</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Теперь вы можете применить такой же метод, как и в примере с факториалом из <em>Распечатки 3</em>, чтобы найти общую стоимость товаров в XML-каталоге. Фактически, решение аналогично решению задачи с факториалом, за исключением того, что вы будете использовать сложение вместо умножения и набор узлов как исходную информацию вместо числа.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Предположим, у вас есть каталог товаров, который выглядит походим на XML в <em>Распечатке 4</em> (кстати, вы можете скачать весь XML и XSL, и весь другой код из этой статьи по ссылке в <a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/xml/library/x-xslrecur/#resources" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk">Ресурсах</a>).</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 4 пример xml с продуктами permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-4-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-xml-%D1%81-%D0%BF%D1%80%D0%BE%D0%B4%D1%83%D0%BA%D1%82%D0%B0%D0%BC%D0%B8"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 4. Пример XML с продуктами</h4><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Products</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Product</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Name</span><span class="token punctuation">&gt;</span></span>Gadget<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Price</span><span class="token punctuation">&gt;</span></span>$10.00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Price</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Product</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Product</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Name</span><span class="token punctuation">&gt;</span></span>Gizmo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Price</span><span class="token punctuation">&gt;</span></span>$7.50<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Price</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Product</span><span class="token punctuation">&gt;</span></span>
  ...
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Products</span><span class="token punctuation">&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Цель в том, чтобы добавить первую цену из этого списка товаров к сумме всех других цен, пока вы не получите суммарный
результат. Вы можете осуществить это при помощи XSL, показанного в <em>Распечатке 5</em>.</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 5 проход по узлам с использованием обычной xsl рекурсии permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-5-%D0%BF%D1%80%D0%BE%D1%85%D0%BE%D0%B4-%D0%BF%D0%BE-%D1%83%D0%B7%D0%BB%D0%B0%D0%BC-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D0%BE%D0%B1%D1%8B%D1%87%D0%BD%D0%BE%D0%B9-xsl-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 5. Проход по узлам с использованием обычной XSL-рекурсии</h4><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSum<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>recursive_result<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSum<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList[position() &gt; 1]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span>
          <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number(substring-after($productList[1]/Price,&#x27;$&#x27;))
                  + $recursive_result<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>when</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>template</span><span class="token punctuation">&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">В этом случае вы вызываете функцию на постепенно уменьшающемся списке товаров, каждый раз добавляя первый элемент в список к рекурсивному вызову на остальных элементах списка. Когда список получается пустым, условие выхода достигнуто и вы добавляете ноль к результату, что не изменит сумму. Этот метод работы на всё меньшем и меньшем наборе узлов может быть использован во многих случаях.</p><h3 class="StyledHeading-sc-1rdh4aw-0 iKIdCK Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="рекурсия вариант 2 итерация на числе permalink" href="#%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D1%8F-%D0%B2%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82-2-%D0%B8%D1%82%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F-%D0%BD%D0%B0-%D1%87%D0%B8%D1%81%D0%BB%D0%B5"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Рекурсия, вариант 2: Итерация на числе</h3><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Вторая задача, с которой сталкиваются XSL-программисты, возникает, когда число содержится в некоторых случаях в исходном XML, и программисту нужно решить задачу это число раз. Например, XML может выключать информацию о сетке с некоторыми числами строк и столбцов, и преобразование необходимое для обеспечения визуального расположения сетки в HTML или каком-либо другом формате.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Решение, как правило используемое разработчиками, незнакомыми с рекурсивными методами - это написать программу, которая разбирает XML и дополняет элементами для каждого ряда или столбца. Однажды написанный элемент <!-- -->&lt;<!-- -->xsl:for-each<!-- -->&gt;<!-- --> может решить задачу без рекурсивных шаблонов. Несмотря на то, что это решение обеспечивает подходящую выдачу, у него есть большой недостаток. Этот метод на самом деле удваивает объём работы для обеспечения финального результата преобразования. Этот недостаток чрезвычайно заметен в клиент-серверной модели, когда сервер посылает XML и XSL для преобразования на клиентской стороне. В таком случае всё продуктивности, обычно реализованные на сервере, теряются за счёт увеличения XML.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Лучшее решение - использовать рекурсивные шаблоны, чтобы выполнять работы полностью в рамках преобразования. Рассмотрим получение таблицы умножения из XML-элемента в виде HTML. Входная информация будет содержать следующую строку:</p><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MultiplicationTable</span> <span class="token attr-name">Rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Цель состоит в том, чтобы преобразовать это в HTML, представляющий таблицу, похожую на:</p><table border="1" cellPadding="5" cellSpacing="0"><tr><td></td><td><strong>1</strong></td><td><strong>2</strong></td><td><strong>3</strong></td><td><strong>4</strong></td></tr><tr><td><strong>1</strong></td><td>1</td><td>2</td><td>3</td><td>4</td></tr><tr><td><strong>2</strong></td><td>2</td><td>4</td><td>6</td><td>8</td></tr><tr><td><strong>3</strong></td><td>3</td><td>6</td><td>9</td><td>12</td></tr></table><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Этот пример кое в чём более сложный, чем первые два. В этом случае вы не просто возвращаете функциональный результат, представляющий решение проблемы, но вы всего лишь выдадите HTML как шаг рекурсивного процесса. Также вам необходимо соединить вместе два рекурсивных шаблона - один для рядов, другой для столбцов.</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 6 повторение по числу с использованием основной xsl рекурсии permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-6-%D0%BF%D0%BE%D0%B2%D1%82%D0%BE%D1%80%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE-%D1%87%D0%B8%D1%81%D0%BB%D1%83-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D0%BE%D0%B9-xsl-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 6. Повторение по числу с использованием основной XSL-рекурсии</h4><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drawRow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentRow<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>totalRows<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>totalCols<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$currentRow &lt;= $totalRows<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drawCell<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentRow<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$currentRow<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentCol<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>totalCols<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$totalCols<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drawRow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentRow<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$currentRow  + 1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>totalRows<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$totalRows<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>totalCols<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$totalCols<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drawCell<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentRow<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentCol<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>totalCols<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$currentCol &lt;= $totalCols<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bgColor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{$bgColor}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">valign</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$value<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drawCell<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentRow<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$currentRow<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentCol<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$currentCol + 1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>totalCols<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$totalCols<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>template</span><span class="token punctuation">&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">В этом случае я использую два отдельный рекурсивных шаблона. Вначале рекурсивно рисую ряды пока не достигну условия выхода. Этот шаблон использует второй рекурсивный шаблон, чтобы нарисовать ячейки для каждого столбца в ряду. Этот общий метод применим для многоуровневого представления данных.</p><h2 class="StyledHeading-sc-1rdh4aw-0 fjsbec Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="оптимизация паттернов рекурсии в xsl permalink" href="#%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D0%BE%D0%B2-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8-%D0%B2-xsl"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Оптимизация паттернов рекурсии в XSL</h2><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">К сожалению, использование рекурсии во многих XSL-процессорах имеет один значительный недостаток при работе с большими объемами данных. Также слишком легко достигнуть переполнения стека (Stack Overflow) или нехватки памяти (Out of Memory) с функциями, которые достигают глубины порядка 10000. Если вы пытаетесь суммировать цены в каталоге с более чем 10000 товарами, вы можете столкнуться с проблемами.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">К счастью, есть пути по оптимизации рекурсивных функций, чтобы уменьшить или даже исключить глубину рекурсии, вытекающую из заданного шаблона. Оставшаяся часть этой статьи представляет четыре способа оптимизировать то, как вы пишете ваши рекурсивные решения на XSL.</p><h3 class="StyledHeading-sc-1rdh4aw-0 iKIdCK Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="оптимизация рекурсии 1 разделяй и властвуй permalink" href="#%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8-1-%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D1%8F%D0%B9-%D0%B8-%D0%B2%D0%BB%D0%B0%D1%81%D1%82%D0%B2%D1%83%D0%B9"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Оптимизация рекурсии 1. Разделяй и властвуй</h3><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Вспомните первый пример, в котором мы пытались найти общую цену, суммировав все цены для нескольких товаров в XML-каталоге. Первоначальный подход - это добавить цену первого товара к сумме всех остальных, и делать это рекурсивно, пока вы не переберёте весь лист. При использовании этого подхода глубина рекурсии равна числу товаров в списке. Сейчас цель состоит в том, чтобы изменить метод так, чтобы вы получили тот же результат без вхождения в рекурсию так глубоко.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Другой подход к этой проблеме - это разделить список на множество меньших частей и делать так рекурсивно, пока вы не разделите каждую часть на отдельные продукты. Самый простой путь представить это - разделение списка напополам, делая рекурсивный вызов на каждой половине и тогда сделать отдельные рекурсивные вызовы на двух получившихся списках. Это позволит завершить всю работу на одной половине, до того как какая-то работа будет сделана на другой половине. Процесс обработки будет древовидный, а не линейный (похожий на лестницу) из первого решения. <em>Рисунок 2</em> показывает это рекурсивное дерево.</p><img src="http://www.ibm.com/developerworks/xml/library/x-xslrecur/tree.gif" alt=""/><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Используя подход &quot;разделяй и властвуй&quot;, вы не ощутите никакой экономии, в цифрах, по числу операций сложения, которые должны быть выполнены. Экономия будет заключаться в том, что операции сложения не ожидают того, чтобы все числа были получены и поставлены в очередь в стек рекурсии для выполнения операции. XSL-код в <em>Распечатке 7</em> показывает такой способ.</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 7 прохождение по узлам с использованием метода разделяй и властвуй permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-7-%D0%BF%D1%80%D0%BE%D1%85%D0%BE%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%BE-%D1%83%D0%B7%D0%BB%D0%B0%D0%BC-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D0%B0-%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D1%8F%D0%B9-%D0%B8-%D0%B2%D0%BB%D0%B0%D1%81%D1%82%D0%B2%D1%83%D0%B9"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 7. Прохождение по узлам с использованием метода &quot;разделяй и властвуй&quot;</h4><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumDivideAndConquer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count($productList) = 1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span>
          <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number(substring-after($productList[1]/Price,&#x27;$&#x27;))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>when</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>halfIndex<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>floor(count($productList) div 2)<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>recursive_result1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumDivideAndConquer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList[position() <span class="token entity named-entity" title="&lt;">&amp;lt;</span>= $halfIndex]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>recursive_result2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumDivideAndConquer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList[position() <span class="token entity named-entity" title="&gt;">&amp;gt;</span> $halfIndex]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$recursive_result1 + $recursive_result2<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>template</span><span class="token punctuation">&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Операция сложения происходит каждый раз, когда разделённый список достигает длины 1 (это является условием выхода), и производится до того, как какая-нибудь обработка произойдёт со второй частью листа. При использовании этой техники глубина рекурсии никогда не превысит log<sub>2</sub> от количества элементов в списке, что, конечно, экспоненциально увеличивает возможное число товаров в списке для этого подсчёта.</p><h3 class="StyledHeading-sc-1rdh4aw-0 iKIdCK Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="оптимизация рекурсии 2 сегментация permalink" href="#%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8-2-%D1%81%D0%B5%D0%B3%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Оптимизация рекурсии 2. Сегментация</h3><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Несмотря на невероятную экономию глубины рекурсии, обеспеченные методом &quot;Разделяй и властвуй&quot;, у него действительно есть недостатки. Для списков длиной не выражается числом степени двойки, этот способ излишне накладный на концах рекурсионного дерева.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Другой подход, который похоже уменьшает глубину рекурсии, работающий на итерациях через сегменты узлов предопределённой длины, предпочтительнее, чем деление узлов надвое каждый раз. Этот подход построен на базовой рекурсивной методике, но представлен внешним шаблоном, который действует как менеджер сегментации.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Роль менеджера сегментации состоит в том, чтобы разбить большую задачу на маленькие, которые могут быть проработаны без появления утечек памяти. Менеджер хранит результаты этих маленьких заданий и в тот момент, когда они все завершены, выполняет необходимую операцию над этими результатами.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Вы можете видеть пример техники Сегментации в шаблоне <em>Распечатки 8</em>, который берёт список узлов и длину сегмента и использует оригинальный шаблон для цен на этих маленьких частях.</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 8 обход узлов с использованием техники сегментации permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-8-%D0%BE%D0%B1%D1%85%D0%BE%D0%B4-%D1%83%D0%B7%D0%BB%D0%BE%D0%B2-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D1%82%D0%B5%D1%85%D0%BD%D0%B8%D0%BA%D0%B8-%D1%81%D0%B5%D0%B3%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D0%B8"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 8. Обход узлов с использованием техники сегментации</h4><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumSegmented<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>segmentLength<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count($productList) &gt; 0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>recursive_result1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSum<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList[position() &lt;= $segmentLength]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>recursive_result2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumSegmented<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList[position() &gt; $segmentLength]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$recursive_result1 + $recursive_result2<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>template</span><span class="token punctuation">&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Использование подхода Сегментации лучше, чем подхода &quot;Разделяй и властвуй&quot; уменьшает накладные расходы в большинстве случаев, но не предлагает особенной выгоды по глубине рекурсии. Какой же следует использовать? Ответ - как вы можете увидеть по следующей оптимизации - оба.</p><h3 class="StyledHeading-sc-1rdh4aw-0 iKIdCK Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="оптимизация рекурсии 3 сочетание сегментации и разделяй и властвуй permalink" href="#%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-%D1%80%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B8-3-%D1%81%D0%BE%D1%87%D0%B5%D1%82%D0%B0%D0%BD%D0%B8%D0%B5-%D1%81%D0%B5%D0%B3%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D0%B8-%D0%B8-%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D1%8F%D0%B9-%D0%B8-%D0%B2%D0%BB%D0%B0%D1%81%D1%82%D0%B2%D1%83%D0%B9"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Оптимизация рекурсии 3. Сочетание Сегментации и &quot;Разделяй и властвуй&quot;</h3><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Вы можете объединить техники &quot;Разделяй и властвуй&quot; и Сегоментации, чтобы</p><ol><li>увеличить экномию за счёт снижения глубины рекурсии (включая накладную обработку, связанную
с каждый добавлением уровня используемой рекурсии)</li><li>избежать накладных расходов на уровне листочков рекурсионного дерева</li></ol><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">В этом способе пороговый уровень передаётся в рекурсивный шаблон, через список узлов (или другие данные, которыми опрерируют). Здесь &quot;Разделяй и властвуй&quot; изменён, чтобы работать как менеджер сегментации. Если размер переданного списка больше, чем пороговое значение, список делится надвое и шаблон рекурсивно вызывается для обеих половин. Другими словами, вы используете основной рекурсивный шаблон, чтобы вычислять результаты, как и в Сегментации.
<em>Распечатка 9</em> показывает этот способ на следующих XSL-шаблонах.</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 9 обход узлов с использованием составной техники разделяй и властвуй и сегментации permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-9-%D0%BE%D0%B1%D1%85%D0%BE%D0%B4-%D1%83%D0%B7%D0%BB%D0%BE%D0%B2-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-%D1%81%D0%BE%D1%81%D1%82%D0%B0%D0%B2%D0%BD%D0%BE%D0%B9-%D1%82%D0%B5%D1%85%D0%BD%D0%B8%D0%BA%D0%B8-%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D1%8F%D0%B9-%D0%B8-%D0%B2%D0%BB%D0%B0%D1%81%D1%82%D0%B2%D1%83%D0%B9-%D0%B8-%D1%81%D0%B5%D0%B3%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D0%B8"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 9. Обход узлов с использованием составной техники &quot;Разделяй и властвуй&quot; и Сегментации</h4><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumCombination<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>threshold<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count($productList) &gt; $threshold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>halfIndex<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>floor(count($productList) div 2)<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>recursive_result1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumCombination<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList[position() &lt;= $halfIndex]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>variable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>recursive_result2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumCombination<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList[position() &gt; $halfIndex]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>variable</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$recursive_result1 + $recursive_result2<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSum<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>template</span><span class="token punctuation">&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">###Оптимизация рекурсии 4. Tail Recursion</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">У вас уже есть какой-то опыт по отношению к рекурсии и вы, возможно, удивлены, почему метод Tail Recursion не первый в способах оптимизации, с тех пор как этот способ может устранить глубокую рекурсию полностью без каких-либо накладных расходов. Несмотря на преимущества, которые этот способ предлагает, он требует, чтобы XSLT-процессор, производя эту трансформацию, распознавал присутствие этой техники в XSL-коде и изменял бы своё поведение для обеспечения этой техники. К сожалению, большинство XSL-процессоров не предлагают такую возможность.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Хорошая новость состоит в том, что непомерное одобрение XSL в бизнесе и научном мире означает, что это ограничение просуществует недолго. По этой причине для разработчиков важно понимать, как происходит отрубание хвоста, как оно может исключить проблемы с памятью без задерживания представления в любом достойном виде.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Основная идея Tail Recursion - это избавление от хранения какой-либо статической информации в рекурсивных шагах. Вся информация, которая нужна, на каждом шаге передаётся как параметры функции вместо того, чтобы храниться на более высоком уровне в стеке рекурсии. Это позволяет XSLT-процессору работать с рекурсивной функцией как с циклом в процедурном языке.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Взгляните на <em>Распечатку 10</em> примера с ценами с Tail Recursion.</p><h4 class="StyledHeading-sc-1rdh4aw-0 gEhQsb Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="распечатка 10 проход по узлам с использованием tail recursion permalink" href="#%D1%80%D0%B0%D1%81%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BA%D0%B0-10-%D0%BF%D1%80%D0%BE%D1%85%D0%BE%D0%B4-%D0%BF%D0%BE-%D1%83%D0%B7%D0%BB%D0%B0%D0%BC-%D1%81-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC-tail-recursion"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Распечатка 10. Проход по узлам с использованием Tail Recursion</h4><div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumTail<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>result<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>call-template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priceSumTail<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productList<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$productList[position() &gt; 1]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>with-param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>result<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$result +
                  number(substring-after($productList[1]/Price,&#x27;$&#x27;))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>call-template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">xsl:</span>value-of</span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$result<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>otherwise</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>choose</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">xsl:</span>template</span><span class="token punctuation">&gt;</span></span></code></pre></div><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Прибавление дополнительного значения переменной создаёт всю разницу. Вместо накомления чисел для сложения на разных рекурсивных шагах, сложение производится на каждом этапе и результат передаётся дальше как параметр для следующего шага рекурсии. Токовый XSLT-процессор просто перезаписывает участок памяти, содержащий значение переменной, при каждом вызове так же, как эта переменная перезаписывалась бы в случае Java или C кода. Этот способ позволяет языку пользоваться преимуществами и декларативных, и императивных языков без изменения сути XSLT как языка программирования.</p><h2 class="StyledHeading-sc-1rdh4aw-0 fjsbec Heading__StyledHeading-sc-1sm1dki-0 dxnfjF"><a target="_blank" rel="noopener" class="StyledAnchor-sc-1rp7lwl-0 fKoXkk anchor before" aria-label="заключение permalink" href="#%D0%B7%D0%B0%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Заключение</h2><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Как только вы поняли рекурсию, декларативный стиль программирования на XSLT будет не препятствием, а эффективным путем расширения возможностей преобразования XML. Остаётся единственный вопрос - какой тип рекурсии лучший для каждой отдельно взятой ситуации.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Вообще, задачи, работающие для малых объёмов данных, не требуют применения какой-либо из этих оптимизационных техник. Хотя, если малость объёма данных не гарантирована, выбор ограничен технологией, используемой в преобразовании. Если ваш XSLT-процессор распознаёт Tail Recursion, то лучше всего использовать этот способ. Если вы не можете убедиться, что преобразовательня технология умеет распознавать Tail Recursion, то наиболее предпочтительна комбинированная техника. Пороговое значение обычно лежит в диапазоне от 5 до 30 в зависимости от задачи.</p><p class="StyledParagraph-sc-tbetod-0 cVYDyA Paragraph__StyledParagraph-sc-15exta6-0 iWdQfn">Поначалу рекурсия может быть трудной для понимания идеей, но её полезность и элегантность становятся яснее по мере использования.</p><div class="StyledBox-sc-13pk1d4-0 bnxvkn"></div></div></main><footer class="StyledBox-sc-13pk1d4-0 juXWcg"><div class="StyledBox-sc-13pk1d4-0 bnacTc"><div class="StyledGrid-sc-1wofa1l-0 yUXFi"><div class="StyledBox-sc-13pk1d4-0 cnYPdO"><p class="StyledParagraph-sc-tbetod-0 gcuCcA Paragraph__StyledParagraph-sc-15exta6-0 cFFcIF">You can hire me to set up, manage, develop, and champion your design system. I can align the design and development processes in your organisation for a larger business impact.</p></div><div class="StyledBox-sc-13pk1d4-0 gDPPjv"><a width="[object Object]" class="Link__AnchorWithoutStyle-sc-1sy1kqy-0 dPnTqb" href="/contact"><div style="text-align:center" type="button" class="StyledButton-sc-323bzc-0 ewhtQA">Get in touch</div></a></div><div class="StyledBox-sc-13pk1d4-0 kZBqJu"><div class="StyledGrommet-sc-19lkkz7-0 eisItN"><nav class="StyledBox-sc-13pk1d4-0 bSRJmJ"><a aria-label="Email" href="mailto:mail@varya.me" class="StyledButtonKind-sc-1vhfpnt-0 dBQJGO"><svg aria-label="Mail" viewBox="0 0 24 24" class="StyledIcon-sc-ofa7kd-0 bxGlvH"><path fill="#01A982" fill-rule="evenodd" d="M23 20V6l-11 9L1 6v14h22zm-11-8 10-8H2l10 8z"></path></svg></a><div class="StyledBox__StyledBoxGap-sc-13pk1d4-1 iamwzK"></div><a aria-label="Twitter" href="https://twitter.com/varya_en" class="StyledButtonKind-sc-1vhfpnt-0 dBQJGO"><svg aria-label="Twitter" viewBox="0 0 24 24" class="StyledIcon-sc-ofa7kd-0 bxGlvH"><path fill="#1DA1F2" fill-rule="evenodd" d="M24 4.309a9.83 9.83 0 0 1-2.828.775 4.94 4.94 0 0 0 2.165-2.724 9.865 9.865 0 0 1-3.127 1.196 4.925 4.925 0 0 0-8.39 4.49A13.974 13.974 0 0 1 1.671 2.9a4.902 4.902 0 0 0-.667 2.476c0 1.708.869 3.216 2.191 4.099A4.936 4.936 0 0 1 .964 8.86v.06a4.926 4.926 0 0 0 3.95 4.829 4.964 4.964 0 0 1-2.224.085 4.93 4.93 0 0 0 4.6 3.42 9.886 9.886 0 0 1-6.115 2.107c-.398 0-.79-.023-1.175-.068a13.945 13.945 0 0 0 7.548 2.212c9.057 0 14.009-7.503 14.009-14.01 0-.213-.005-.425-.014-.636A10.012 10.012 0 0 0 24 4.309"></path></svg></a><div class="StyledBox__StyledBoxGap-sc-13pk1d4-1 iamwzK"></div><a aria-label="Linkedin" href="https://www.linkedin.com/in/varyastepanova/" class="StyledButtonKind-sc-1vhfpnt-0 dBQJGO"><svg aria-label="Linkedin" viewBox="0 0 24 24" class="StyledIcon-sc-ofa7kd-0 bxGlvH"><path fill="#0077B5" fill-rule="evenodd" d="M20.452 20.45h-3.56v-5.57c0-1.328-.022-3.036-1.85-3.036-1.851 0-2.134 1.447-2.134 2.942v5.664H9.352V8.997h3.413v1.566h.049c.475-.9 1.636-1.85 3.367-1.85 3.605 0 4.27 2.371 4.27 5.456v6.281zM5.339 7.433a2.063 2.063 0 1 1 0-4.13 2.065 2.065 0 0 1 0 4.13zM7.12 20.45H3.558V8.997H7.12V20.45zM23 0H1a1 1 0 0 0-1 1v22a1 1 0 0 0 1 1h22a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg></a><div class="StyledBox__StyledBoxGap-sc-13pk1d4-1 iamwzK"></div><a aria-label="Facebook" href="http://www.facebook.com/varvara.stepanova.9" class="StyledButtonKind-sc-1vhfpnt-0 dBQJGO"><svg aria-label="Facebook" viewBox="0 0 24 24" class="StyledIcon-sc-ofa7kd-0 bxGlvH"><path fill="#3B5998" fill-rule="evenodd" d="M23 0H1a1 1 0 0 0-1 1v22a1 1 0 0 0 1 1h11.75v-9h-3v-3.75h3v-3c0-3.1 1.963-4.625 4.728-4.625 1.324 0 2.463.099 2.794.142v3.24l-1.917.001c-1.504 0-1.855.715-1.855 1.763v2.479h3.75L19.5 15h-3l.06 9H23a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1"></path></svg></a></nav></div></div><div class="StyledBox-sc-13pk1d4-0 fieDOB"><span class="StyledText-sc-1sadyjn-0 iZZpUp">© Varya Stepanova <!-- -->2022</span></div></div></div></footer></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VNR46J539J"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-VNR46J539J', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ru/posts/xslt-recursion/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-1b9e622737603548a09c.js"],"app":["/app-f4b7c1d760c3590389ba.js"],"component---src-pages-404-js":["/component---src-pages-404-js-1d4fda1efc22583533c3.js"],"component---src-pages-articles-and-talks-js":["/component---src-pages-articles-and-talks-js-0d974b821061ec645569.js"],"component---src-pages-contact-js":["/component---src-pages-contact-js-273c449bc3384049516e.js"],"component---src-pages-design-systems-js":["/component---src-pages-design-systems-js-f13c7ae3025adfe9ee3e.js"],"component---src-pages-index-js":["/component---src-pages-index-js-b5f7dfe85a79659a0416.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-36e8874b63496f010036.js"],"component---src-pages-services-audit-js":["/component---src-pages-services-audit-js-fc8ccc2c911409ca7bc2.js"],"component---src-pages-services-consultancy-js":["/component---src-pages-services-consultancy-js-a1bd106284e56bbeff99.js"],"component---src-pages-services-development-js":["/component---src-pages-services-development-js-34f649eefda48eb914b0.js"],"component---src-pages-services-index-js":["/component---src-pages-services-index-js-4e6b9bb581d781b28024.js"],"component---src-pages-services-speaking-js":["/component---src-pages-services-speaking-js-6de82d5886a3c0810f7e.js"],"component---src-pages-services-strategy-js":["/component---src-pages-services-strategy-js-dc5ab8a1689ca52ae3d3.js"],"component---src-pages-services-supervision-js":["/component---src-pages-services-supervision-js-25c4f9150f712d7ba96c.js"],"component---src-pages-services-workshops-js":["/component---src-pages-services-workshops-js-a7253a25da6ae800adab.js"],"component---src-templates-blog-index-js":["/component---src-templates-blog-index-js-e708ed69d449615fe1b8.js"],"component---src-templates-post-js":["/component---src-templates-post-js-f439b2c003b946e312ce.js"],"component---src-templates-tag-index-js":["/component---src-templates-tag-index-js-30f624f22d572f082857.js"]};/*]]>*/</script><script src="/polyfill-1b9e622737603548a09c.js" nomodule=""></script><script src="/component---src-templates-post-js-f439b2c003b946e312ce.js" async=""></script><script src="/app-f4b7c1d760c3590389ba.js" async=""></script><script src="/29107295-c94de8149487fc10d0b0.js" async=""></script><script src="/styles-2145f6021e9dfb9c659e.js" async=""></script><script src="/framework-e5e95b94de229fe789b2.js" async=""></script><script src="/webpack-runtime-3e231e9c75d1714f579e.js" async=""></script></body></html>