<!DOCTYPE html>
<html class="page page_en" lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Dealing atomically with icon fonts</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico"/>
    <link  rel="stylesheet" href="/desktop.bundles/index/index.min.css" />
    <script>
    (function(d, s, l, r) {
    if (typeof(s) !== 'undefined' && l.getItem('varya.me.fonts')) {
        r = [
            '<style>',
            l.getItem('varya.me.fonts'),
            '</style>'
        ];
        document.write(r.join(''));
    }

    })(document, Storage, localStorage);
  </script>
  <meta content='Fixing the "using UI library" workflow with building icon fonts from atomic SVG icons. The library has its own flow, and obviously the new things can only appear in new versions. However the library customers sometimes cannot wait even an hour. With the atomic builds you can easily provide library customer with the freedom to modify everything. Even icon fonts.
' property="og:description"/><meta content="http://varya.me/posts/dealing-atomically-with-icon-fonts/thumb.png" property="og:image"/><meta content="Dealing atomically with icon fonts" property="og:title"/><meta content="http://varya.me/en/posts/dealing-atomically-with-icon-fonts/" property="og:url"/><meta property="og:site_name" content="var ya;"/><meta property="og:type" content="article"/><meta property="og:locale" content="en_US"/> <meta property="article:author" content="https://www.facebook.com/toivonens"/>
</head>
<body class="page page__body">
    <header class="header">
        <div class="header__left candies i-bem"
            data-bem='{ "candies" : { "size" : { "max" : 28, "min" : 12 }, "reverse" : true } }'></div>
        <div class="header__center">
            <logo class="logo">···<b class="var">var</b>·<b class="ya">ya</b>;<b class="cursor"></b></logo>
        </div>
        <div class="header__right candies i-bem"
            data-bem='{ "candies" : { "size" : { "max" : 28, "min" : 12 } } }'></div>
    </header>
    <div class="layout">
        <section class="main">
            <ul class="languages">
            
                <li class="languages__lang">
                    
                        en
                    
                </li>
                
                <li class="languages__lang">
                    
                    <a href="/ru/">
                        ru
                    </a>
                    
                </li>
                
            </ul>
            <div class="article" role="main">
    <div class="article__body box__body">
        <h1 class="article__header">
            Dealing atomically with icon fonts
        </h1>
    </div>
    <div class="article__text box__island">
        <script type="text/javascript" src="//yandex.st/share/share.js"
        charset="utf-8"></script>
        <div class="share yashare-auto-init" data-yashareL10n="{{ lang }}"
            data-yashareQuickServices="twitter,facebook,gplus" data-yashareTheme="counter"
        ></div>
        <span class="article__details author vcard">
            Published on
            10th November 2015
        </span>
        <p>My recent huge project was developing a library of CSS and JavaScript components for sharing this code across a lot of
web services and mobile apps. In most cases such work brings up question about how to avoid blocking the processes.</p>
<p>The library has its own flow, and obviously the new things can only appear in new versions. Although I made my best to
provide fast releases, and so the library has them 2-3 times a week, it is still understandable that the library
customers sometimes cannot wait even an hour.</p>
<p>I belive that one of the must-haves of UI library is the freedom which it should give to its customers. You can easily
provide this if practice atomic approach everythere. For example, for the icon fonts.</p>
<excerpt/>

<h3 id="solid-piece">Solid piece</h3>
<p>Soon or not SVG will conquer the world. But now we still have icon fonts in some projects. The same story was with that
library.</p>
<p>However the icon font perfectly suited for the displaying icons onto the web pages, it was integration and flow which
created the problem. All the icons fit into one font file (well, in 4 different formats):</p>
<pre class="highlight"><code class="hljs stylus">src/
  fonts/
    iconfont<span class="hljs-class">.eot</span>
    iconfont<span class="hljs-class">.svg</span>
    iconfont<span class="hljs-class">.ttf</span>
    iconfont<span class="hljs-class">.woff</span>
</code></pre><p>Also the library provided CSS to make the icon-symbol matching:</p>
<pre class="highlight"><code class="hljs scss"><span class="hljs-class">.icon</span> {
  <span class="hljs-attribute">font-family</span><span class="hljs-value">: <span class="hljs-variable">$global-font-icon</span>;</span>
  &amp;<span class="hljs-pseudo">:before</span> {
    <span class="hljs-comment">/* Some common icon stuff */</span>
  }
  &amp;--support {
    &amp;<span class="hljs-pseudo">:before</span> {
      <span class="hljs-attribute">content</span><span class="hljs-value">: <span class="hljs-string">"a"</span>;</span>
    }
  }
  &amp;--chat {
    &amp;<span class="hljs-pseudo">:before</span> {
      <span class="hljs-attribute">content</span><span class="hljs-value">: <span class="hljs-string">"b"</span>;</span>
    }
  }
  ...
}
</code></pre>
<p>Customers get the library as a bower or npm package. When they need a new icon to be in the set, they might request this
and wait for the package to update. As usual, the fastest way to get something happened is to do this yourself. So, it
possible to contribute and even release yourself. But still any further change would need you to go through the
development process.</p>
<h3 id="atomic-and-buildable">Atomic and buildable</h3>
<p>Often you need to divide into smaller pieces in order to make things more mantainable. The same goes with icons. In the
library we changed it so that the source is now a set of SVG files:</p>
<pre class="highlight"><code class="hljs stylus">src/
  icons/
    <span class="hljs-number">1000</span>-support<span class="hljs-class">.svg</span>
    <span class="hljs-number">1010</span>-chat<span class="hljs-class">.svg</span>
    <span class="hljs-number">1020</span>-users<span class="hljs-class">.svg</span>
</code></pre><p>The file names are important, these words are used to generate the CSS classes, which are the API for the customer.
Numbers are for the right order. If building the icon system from very beginning, they are not needed. But in the
library case I wanted backward compatibility.</p>
<p>Then, these icons are built into the same icon fonts with <code>gulp-iconfont</code> plugin:</p>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">"gulp"</span>);
<span class="hljs-keyword">var</span> iconfont = <span class="hljs-built_in">require</span>(<span class="hljs-string">"gulp-iconfont"</span>);
<span class="hljs-keyword">var</span> consolidate = <span class="hljs-built_in">require</span>(<span class="hljs-string">"gulp-consolidate"</span>);

<span class="hljs-keyword">var</span> sourcePath = <span class="hljs-string">"src/"</span>;

gulp.task(<span class="hljs-string">"build:icons"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> gulp.src([sourcePath + <span class="hljs-string">"/icons/*.svg"</span>])
      .pipe(iconfont({
        fontName: <span class="hljs-string">"myicons"</span>,
        formats: [<span class="hljs-string">"ttf"</span>, <span class="hljs-string">"eot"</span>, <span class="hljs-string">"woff"</span>, <span class="hljs-string">"svg"</span>],
        centerHorizontally: <span class="hljs-literal">true</span>,
        fixedWidth: <span class="hljs-literal">true</span>
      }))
      .on(<span class="hljs-string">"glyphs"</span>, (glyphs) =&gt; {

        glyphs.forEach((icon) =&gt; {
          icon.name = icon.name.replace(<span class="hljs-regexp">/^\d+\-/g</span>, <span class="hljs-string">""</span>);
        });

        gulp.src(sourcePath + <span class="hljs-string">"/icons/util/*.scss"</span>) <span class="hljs-comment">// Template</span>
            .pipe(consolidate(<span class="hljs-string">"lodash"</span>, {
                glyphs: glyphs,
                fontName: <span class="hljs-string">"myiconfont"</span>,
                fontPath: <span class="hljs-string">"../fonts/"</span>
            }))
            .pipe(gulp.dest(sourcePath + <span class="hljs-string">"/scss/"</span>));
      })
      .pipe(gulp.dest(sourcePath + <span class="hljs-string">"/fonts/"</span>));
});
</code></pre>
<p>Besides the icon files this task needs the templates to produce the CSS (or SCSS, as in this case) which makes the
symbol-class matching. I found it logical to store it together with the icon files:</p>
<pre class="highlight"><code class="hljs stylus">src/
  icons/
    utils/
      iconfont__icons<span class="hljs-class">.scss</span>
      iconfont__variables<span class="hljs-class">.scss</span>
</code></pre><p>It&#39;s possible to manage with one template only, but for even more flexibility I have two. The main one makes the
classes:</p>
<pre class="highlight"><code class="hljs undefined">@font-face {
  font-family: $global-font-icon;
  src:url("&lt;%= fontPath %&gt;&lt;%= fontName %&gt;..eot");
  src:url("&lt;%= fontPath %&gt;&lt;%= fontName %&gt;.?#iefix") format("embedded-opentype"),
    url("&lt;%= fontPath %&gt;&lt;%= fontName %&gt;.woff") format("woff"),
    url("&lt;%= fontPath %&gt;&lt;%= fontName %&gt;.ttf") format("truetype"),
    url("&lt;%= fontPath %&gt;&lt;%= fontName %&gt;.#&lt;%= fontName %&gt;") format("svg");
  font-weight: normal;
  font-style: normal;
}

.icon {
  font-family: $global-font-icon;

  &amp;:before {
    /* Some common icon stuff */
  }
&lt;% _.each(glyphs, function(glyph) { %&gt;
  &amp;.--&lt;%= glyph.name %&gt; {
    &amp;:before {
      content: $icon--&lt;%= glyph.name %&gt;;
    }
  }&lt;% }); %&gt;

}
</code></pre>
<p>And another one makes the varibles:</p>
<pre class="highlight"><code class="hljs undefined">&lt;% _.each(glyphs, function(glyph) { %&gt;
$icon-&lt;%= glyph.name %&gt;: "\&lt;%= glyph.unicode[0].charCodeAt(0).toString(16).toUpperCase() %&gt;" !default;
&lt;% }); %&gt;
</code></pre>
<p>Running the task produces the fonts and 2 generic SCSS files:</p>
<pre class="highlight"><code class="hljs stylus">src/
  <span class="hljs-attribute">font</span>/
    iconfont<span class="hljs-class">.eot</span>
    iconfont<span class="hljs-class">.svg</span>
    iconfont<span class="hljs-class">.ttf</span>
    iconfont<span class="hljs-class">.woff</span>
  scss/
    icons<span class="hljs-class">.scss</span> <span class="hljs-comment">// Not generic</span>
    iconfont__icons<span class="hljs-class">.scss</span>
    iconfont__variables<span class="hljs-class">.scss</span>
</code></pre><p>In the <code>icons.scss</code>, which is normal SCSS file, the result is requested:</p>
<pre class="highlight"><code class="hljs undefined">// Icons
//
// Lists all the icons that are used in the services.
//
// Styleguide 5

@import "iconfont__variables.scss";
@import "iconfont__icons.scss";
</code></pre>
<h3 id="extend-on-fly">Extend on fly</h3>
<p>The variables may be redefined on the customer&#39;s side. This makes is a fast way to change the icon, if the replacement
already sit in the font bundle.</p>
<p>If not, it is almost zero amout of work to implement this build-from-atoms process on the customer side.</p>
<p>The customer has all the library code, let&#39;s say in <code>bower_components</code>, and can have its own folder of icons:</p>
<pre class="highlight"><code class="hljs stylus">bower_components/
  ui-library/
    dist/
      icons/
      scss/
src/
  icons/
    <span class="hljs-number">2000</span>-rabbit<span class="hljs-class">.svg</span>
    <span class="hljs-number">2010</span>-gift<span class="hljs-class">.svg</span>
</code></pre><p>When building the font they need to use both their set of icons and the library icons:</p>
<pre class="highlight"><code class="hljs javascript">
<span class="hljs-keyword">var</span> sourcePath = <span class="hljs-string">"src/"</span>;

gulp.task(<span class="hljs-string">"build:icons"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> gulp.src([sourcePath + <span class="hljs-string">"/icons/*.svg"</span>, <span class="hljs-string">"bower_components/ui-library/dist/icons/*.svg"</span>])
      .pipe(iconfont({
        <span class="hljs-comment">/* The same as above */</span>
      }))
      .on(<span class="hljs-string">"glyphs"</span>, (glyphs) =&gt; {

        gulp.src(<span class="hljs-string">"bower_components/ui-library/dist/icons/util/*.scss"</span>)
            .pipe(consolidate(<span class="hljs-string">"lodash"</span>, {
                <span class="hljs-comment">/* The same as above */</span>
            }))
            .pipe(gulp.dest(sourcePath + <span class="hljs-string">"/scss/"</span>));
      })
      .pipe(gulp.dest(sourcePath + <span class="hljs-string">"/fonts/"</span>));
});
</code></pre>
<p>It is not even needed to implement template for the output SCSS, it comes in the library dist.</p>
<p>With such a flow a UI library customer stays completely independent from the library release cycle and may bring a new
icon into her product as soon as the atomic SVG file is copied into the needed folder. As a background process it is
needed to contribute the same icon into the library, but not necessarily the same moment. And even the contributing
process is changed to be better because it came to adding an SVG file.</p>
<p>As other atomical things, such font flow makes git history more useful. Now it is easier to see
if the provided change affected many or just one icon. Also, SVG images are rendered nicely in pull requests.</p>
<p>Even simultaneous changes of the icons in both library and customer websites are possible and should not cause any
conflict.</p>
<p>And the last but not least nice thing: all the icons are now in the library as SVG files. Hopefully later we come up
with using next century technologies and not the icons fonts. When this sweet moment comes, half of the work will have
been done :-)</p>

    </div>
    <div class="comments">
        <div class="comments__box box__body">
            <h4 class="comments__header">
                Comments
            </h4>
        </div>
        <div class="comments__body box__island">
            
              
                  <div id="disqus_thread"></div>
<script>
	(function(){
		window.disqus_shortname = 'varya';
		window.disqus_developer = '1';
		window.disqus_url = 'http://varya.me//en/posts/dealing-atomically-with-icon-fonts';
		window.disqus_identifier = 'posts-dealing-atomically-with-icon-fonts-index-en';
		window.disqus_title = 'Dealing atomically with icon fonts';
		if ( window.DISQUS ) {
			return DISQUS.reset({
				reload: true,
				config: function () {
					this.page.identifier = window.disqus_identifier;
					this.page.url = window.disqus_url;
					this.page.title = window.disqus_title;
				}
			});
		}
		else {
		  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		}
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
              
            
        </div>
    </div>
    <div class="related">
        <div class="related__body box__body">
            <h4 class="related__header">
                By the way
            </h4>
        </div>
        <div class="related__text box__island">
                <a href="https://github.com/varya/varya.github.com/issues/new?title=Feedback for Dealing atomically with icon fonts">
                Create a GitHub issue for me</a> if you've spotted a typo or a mistake, or wish to add something on.
                Or you can
                <a href="https://github.com/varya/varya.github.com/edit/develop/src/documents/posts/dealing-atomically-with-icon-fonts/index_en.html.md">edit this post yourself and make me a patch</a>.
        </div>
    </div>
</div>
        </section>
        <nav class="sidebar">
        <ul class="menu-vert">
            <h3 class="menu-vert__title box__title">
                On this site
            </h3>
            
                <li class="menu-vert__item ">
                    <a class="link" href="/en/posts">
                        Tech Blog
                    </a>
                </li>
            
                <li class="menu-vert__item ">
                    <a class="link" href="/en/content">
                        Articles and talks
                    </a>
                </li>
            
                <li class="menu-vert__item ">
                    <a class="link" href="/">
                        About me
                    </a>
                </li>
            
                <li class="menu-vert__item ">
                    <a class="link" href="/en/life">
                        My life
                    </a>
                </li>
            
            </ul>
            <div class="github i-bem box github_not-ready"
                data-bem='{ "github" : { "user" : "varya" } }'>
                <div class="github__header box__title">
                  Last updated repos
                </div>
                <ul class="github__body"></ul>
            </div>
        </nav>
        <aside class="prompting">
            <ul class="social-ico menu-vert">
                <li class="menu-vert__item">
                    <ul class="social-ico__text menu-vert">
                        <li class="menu-vert__item">
                            <a class="link social-ico__rss-text" href="/en/feed.xml" title="New on Varya.me in English">en</a>
                        </li>
                        <li class="menu-vert__item">
                            <a class="link social-ico__rss-text" href="/ru/feed.xml" title="Новые записи на Varya.me">ru</a>
                        </li>
                    </ul>
                    <a class="link social-ico__ico social-ico__ico_type_rss" href="/feed.xml" title="New on Varya.me"></a>
                </li>
                <li class="menu-vert__item">
                <a class="link social-ico__ico social-ico__ico_type_twitter"
                    href="https://twitter.com/varya_en"
                    title="@varya_en"
                    target="_blank"></a>
                </li>
                <li class="menu-vert__item">
                    <a class="link social-ico__ico social-ico__ico_type_github" href="https://github.com/varya" target="_blank"></a>
                </li>
                <li class="menu-vert__item">
                    <a class="link social-ico__ico social-ico__ico_type_facebook" href="http://www.facebook.com/varvara.stepanova.9" target="_blank"></a>
                </li>
                <li class="menu-vert__item">
                    <a class="link social-ico__ico social-ico__ico_type_linkedin" href="http://www.linkedin.com/pub/varvara-stepanova/30/72a/96b" target="_blank"></a>
                </li>
            </ul>
        </aside>
    </div>
    <div class="footer__outer">
        <footer class="footer">
            <div class="footer__left">
            </div>
            <div class="footer__center">
                <a class="link  link_text  link_wrapper" href="http://varya.me/">
                    © 2015
                    <span class="link__inner">Varya Stepanova</span>.
                </a>
                <a class="link  link_wrapper  link_twitter"
                    href="https://twitter.com/varya_en"
                    title="@varya_en">
                    <img alt="Twitter" class="ico" src="http://favicon.yandex.net/favicon/twitter.com" title="Twitter"/>
                    <span class="link__inner">Follow me on twitter</span>!
                </a>
            </div>
            <div class="footer__right">
            </div>
        </footer>
    </div>
    <!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20478625 = new Ya.Metrika({id:20478625, clickmap:true, trackLinks:true, accurateTrackBounce:true, trackHash:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/20478625" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter -->
    <script src="http://yandex.st/jquery/1.7.2/jquery.min.js"></script>
    <script src="/desktop.bundles/index/index.min.js" async defer></script>
</body>
</html>
